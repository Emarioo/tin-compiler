struct Array {
    ptr: Location*,
    size: int,
}
struct Location {
    line: int,
}

fun strlen(str: char*): int {
    length: int; // zero initialized
    while str[length] {
        length++;
    }
    return length;
}
fun find_string(str: char*, text: char*, text_size: int) {
    str_length: int = strlen(str);
    index: int;
    correct: int;
    array.ptr = cast Location*  malloc(sizeof Location * 100);
    array.size = 0;
    line: int = 1;
    while index < text_size {
        if text[index] == '\n' {
            line++;
        }
        if str[correct] == text[index] {
            correct++;
            if correct == str_length {
                correct = 0;
                array.ptr[array.size].line = line;
                array.size++;
            }
        } else {
            correct = 0;
        }
        index++;
    }
}
global array: Array;
fun main() {
    text: char*;
    size: int;
    read_file("tests/feature_set.tin", &text, &size);

    find_string("int",text,size);

    prints("Found ");
    prints("int ");
    printi(array.size);
    prints(" times here:\n");
    i: int;
    while i < array.size {
        prints(" LN ");
        printi(array.ptr[i].line);
        printc('\n');
        i++;
    }
}